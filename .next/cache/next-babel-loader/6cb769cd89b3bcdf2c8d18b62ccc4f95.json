{"ast":null,"code":"import _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _initializerDefineProperty from \"@babel/runtime-corejs2/helpers/esm/initializerDefineProperty\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _applyDecoratedDescriptor from \"@babel/runtime-corejs2/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"@babel/runtime-corejs2/helpers/esm/initializerWarningHelper\";\n\nvar _class, _descriptor, _descriptor2, _descriptor3, _descriptor4, _temp;\n\nimport { observable, action, runInAction } from 'mobx';\nimport axios from 'axios';\nvar AuthStore = (_class = (_temp =\n/*#__PURE__*/\nfunction () {\n  function AuthStore(_token) {\n    var _this = this;\n\n    _classCallCheck(this, AuthStore);\n\n    _initializerDefineProperty(this, \"token\", _descriptor, this);\n\n    _initializerDefineProperty(this, \"inProgress\", _descriptor2, this);\n\n    _initializerDefineProperty(this, \"authData\", _descriptor3, this);\n\n    _initializerDefineProperty(this, \"userData\", _descriptor4, this);\n\n    this.fetch =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(token) {\n        var response, result;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return axios({\n                  method: 'get',\n                  url: 'http://localhost:8000/api/auth/check',\n                  headers: {\n                    'jwt': token\n                  },\n                  withCredentials: true\n                });\n\n              case 2:\n                response = _context.sent;\n                result = response.data.info;\n                console.log(\"result\", result);\n\n                _this.setUserData(result);\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    this.fetch2 =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var response, result;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return axios({\n                method: 'get',\n                url: 'http://localhost:8000/api/auth/check',\n                // headers: {'jwt':token},\n                withCredentials: true\n              });\n\n            case 2:\n              response = _context2.sent;\n              result = response.data.info;\n              console.log(\"result\", result);\n\n              _this.setUserData(result);\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    this.setToken(_token); // this.fetch(token)\n  }\n\n  _createClass(AuthStore, [{\n    key: \"setToken\",\n    value: function setToken(token) {\n      this.token = token;\n    }\n  }, {\n    key: \"setEmail\",\n    value: function setEmail(email) {\n      this.authData.email = email;\n    }\n  }, {\n    key: \"setPassword\",\n    value: function setPassword(password) {\n      this.authData.password = password;\n    }\n  }, {\n    key: \"setUsername\",\n    value: function setUsername(username) {\n      this.authData.username = username;\n    }\n  }, {\n    key: \"login\",\n    value: function () {\n      var _login = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var response;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return axios({\n                  method: 'post',\n                  url: 'http://localhost:8000/api/auth/login',\n                  data: {\n                    email: this.authData.email,\n                    password: this.authData.password\n                  }\n                });\n\n              case 2:\n                response = _context3.sent;\n                runInAction(function () {\n                  document.cookie = \"jwt=\".concat(response.data.token);\n                });\n                console.log(\"token in AuthStore: \", this.token);\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function login() {\n        return _login.apply(this, arguments);\n      }\n\n      return login;\n    }() // 쿠키 속 jwt로 자동 로그인 하는 로직\n\n  }, {\n    key: \"setUserData\",\n    value: function setUserData(userData) {\n      this.userData.email = userData.email;\n      this.userData.username = userData.username;\n    } // logout할 때 가지고 있던 쿠키 만료 & 삭제 하는 로직\n    // // @action reset() {\n    // //   this.authData.email\n    // //   this.authData.password\n    // //   this.authData.username\n    // // }\n    // @action async register() {\n    //   const response = await axios({\n    //     method: 'post',\n    //     url: 'http://localhost:8000/api/auth/register',\n    //     data: {\n    //       email: this.authData.email,\n    //       password: this.authData.password,\n    //       username: this.authData.username\n    //     }\n    //   })\n    //   // 회원가입하고 쿠키에 토큰 넣는 로직 만들어야 함!!\n    //   runInAction(() => {\n    //     this.token = response.data.token\n    //   })\n    // }\n    // @action async check() {\n    //   const response = await axios({\n    //     method: 'get',\n    //     url: 'http://localhost:8000/api/auth/check',\n    //     headers: {'x-access-token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZDM2YWQ2NmE5YjI1Njg3NDFhYmY4ODciLCJlbWFpbCI6IndpdGh5akBjb2RlaXQua3IiLCJ1c2VybmFtZSI6Im1hc3RlciIsImFkbWluIjp0cnVlLCJpYXQiOjE1NjM5NTM3NDcsImV4cCI6MTU2NDU1ODU0NywiaXNzIjoiY29kZWl0LmtyIiwic3ViIjoidXNlckluZm8ifQ.QDdr_sA-j2IDoKa9uv3RFSMGUSk3ZKpN4M3EyPWvc8Y'}\n    //   })\n    //   runInAction(() => {\n    //     this.userData.email = response.data.info.email\n    //     this.userData.username = response.data.info.username\n    //   })\n    // }\n\n  }]);\n\n  return AuthStore;\n}(), _temp), (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"token\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return \"기본값\";\n  }\n}), _descriptor2 = _applyDecoratedDescriptor(_class.prototype, \"inProgress\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor3 = _applyDecoratedDescriptor(_class.prototype, \"authData\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      email: '',\n      password: '',\n      username: ''\n    };\n  }\n}), _descriptor4 = _applyDecoratedDescriptor(_class.prototype, \"userData\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      email: '',\n      username: '',\n      userState: ''\n    };\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"setToken\", [action], _Object$getOwnPropertyDescriptor(_class.prototype, \"setToken\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setEmail\", [action], _Object$getOwnPropertyDescriptor(_class.prototype, \"setEmail\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setPassword\", [action], _Object$getOwnPropertyDescriptor(_class.prototype, \"setPassword\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setUsername\", [action], _Object$getOwnPropertyDescriptor(_class.prototype, \"setUsername\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"login\", [action], _Object$getOwnPropertyDescriptor(_class.prototype, \"login\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setUserData\", [action], _Object$getOwnPropertyDescriptor(_class.prototype, \"setUserData\"), _class.prototype)), _class);\nexport { AuthStore };","map":{"version":3,"sources":["/Users/withyj/OtherProjects/MobxForReal/src/stores/AuthStore.ts"],"names":["observable","action","runInAction","axios","AuthStore","token","fetch","method","url","headers","withCredentials","response","result","data","info","console","log","setUserData","fetch2","setToken","email","authData","password","username","document","cookie","userData","userState"],"mappings":"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","sourcesContent":["import { observable, action, runInAction } from 'mobx';\nimport axios from 'axios'\n\nclass AuthStore {\n  @observable private token = \"기본값\";\n  @observable inProgress: Boolean = false;\n  @observable authData = {\n    email: '',\n    password: '',\n    username: '',\n  };\n  @observable userData = {\n    email: '',\n    username: '',\n    userState: ''\n  }\n\n  constructor(token:string) {\n    this.setToken(token)\n    // this.fetch(token)\n  }\n\n  @action setToken(token) { this.token = token }\n\n  @action setEmail(email) { this.authData.email = email }\n  @action setPassword(password) { this.authData.password = password }\n  @action setUsername(username) { this.authData.username = username }\n\n  @action async login() {\n    const response = await axios({\n      method: 'post',\n      url: 'http://localhost:8000/api/auth/login',\n      data: {\n        email: this.authData.email,\n        password: this.authData.password,\n      }\n    })\n\n    runInAction(() => {\n      document.cookie = `jwt=${response.data.token}`\n    })\n    console.log(\"token in AuthStore: \", this.token)\n  }\n\n  // 쿠키 속 jwt로 자동 로그인 하는 로직\n  fetch = async (token) => {\n    const response = await axios({\n      method: 'get',\n      url: 'http://localhost:8000/api/auth/check',\n      headers: {'jwt':token},\n      withCredentials: true\n    })\n    const result = response.data.info\n    console.log(\"result\", result)\n    this.setUserData(result);\n  }\n\n  fetch2 = async () => {\n    const response = await axios({\n      method: 'get',\n      url: 'http://localhost:8000/api/auth/check',\n      // headers: {'jwt':token},\n      withCredentials: true\n    })\n    const result = response.data.info\n    console.log(\"result\", result)\n    this.setUserData(result);\n  }\n\n  @action setUserData(userData) {\n    this.userData.email = userData.email;\n    this.userData.username = userData.username;\n  }\n\n\n  // logout할 때 가지고 있던 쿠키 만료 & 삭제 하는 로직\n\n  // // @action reset() {\n  // //   this.authData.email\n  // //   this.authData.password\n  // //   this.authData.username\n  // // }\n\n  // @action async register() {\n  //   const response = await axios({\n  //     method: 'post',\n  //     url: 'http://localhost:8000/api/auth/register',\n  //     data: {\n  //       email: this.authData.email,\n  //       password: this.authData.password,\n  //       username: this.authData.username\n  //     }\n  //   })\n\n  //   // 회원가입하고 쿠키에 토큰 넣는 로직 만들어야 함!!\n  //   runInAction(() => {\n  //     this.token = response.data.token\n  //   })\n  // }\n\n  // @action async check() {\n  //   const response = await axios({\n  //     method: 'get',\n  //     url: 'http://localhost:8000/api/auth/check',\n  //     headers: {'x-access-token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZDM2YWQ2NmE5YjI1Njg3NDFhYmY4ODciLCJlbWFpbCI6IndpdGh5akBjb2RlaXQua3IiLCJ1c2VybmFtZSI6Im1hc3RlciIsImFkbWluIjp0cnVlLCJpYXQiOjE1NjM5NTM3NDcsImV4cCI6MTU2NDU1ODU0NywiaXNzIjoiY29kZWl0LmtyIiwic3ViIjoidXNlckluZm8ifQ.QDdr_sA-j2IDoKa9uv3RFSMGUSk3ZKpN4M3EyPWvc8Y'}\n  //   })\n\n  //   runInAction(() => {\n  //     this.userData.email = response.data.info.email\n  //     this.userData.username = response.data.info.username\n  //   })\n  // }\n}\nexport { AuthStore }"]},"metadata":{},"sourceType":"module"}